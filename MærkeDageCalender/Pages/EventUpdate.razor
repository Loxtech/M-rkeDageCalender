@page "/event/update/{eventId:int}"

@using MærkeDageCalender.Data
@using DataAccessLibrary.Models

@inject EntityFrameworkCRUD entity
@inject SqlConnectionCRUD sqlcon
@inject LinQCRUD linq
@inject Date date
@inject SelectedOptionService SelectedOptionService
@inject NavigationManager _navigationManager
@inject BirthdayModel birthdayModel

<h3>Edit Event</h3>

<form>
    <div class="form-group">
        <label for="eventDate">Event Date:</label>
        <input type="date" class="form-control" id="eventDate" @bind="birthdayModel.Date" />
    </div>
    <div class="form-group">
        <label for="eventName">Event Name:</label>
        <input type="text" class="form-control" id="eventName" @bind="birthdayModel.EventName" />
    </div>
    <button type="button" class="btn btn-primary" @onclick="UpdateEvent">
    <ion-icon name="save-outline" size="large" aria-hidden="true"></ion-icon></button>
</form>

@code {

    [Parameter] public int eventId { get; set; }


    private void UpdateEvent()
    {
        if (SelectedOptionService.SelectedOption == CRUDTypeEnum.entityFramework.ToString())
        {
            entity.UpdateBirthday(birthdayModel);
        }
        else if (SelectedOptionService.SelectedOption == CRUDTypeEnum.sqlCon.ToString())
        {
            sqlcon.UpdateBirthday(birthdayModel);
        }
        else if (SelectedOptionService.SelectedOption == CRUDTypeEnum.linQ.ToString())
        {
            linq.UpdateBirthday(birthdayModel);
        }

        _navigationManager.NavigateTo("/Calender");
    }

    protected override void OnInitialized()
    {
        if (SelectedOptionService.SelectedOption == CRUDTypeEnum.entityFramework.ToString())
        {
            birthdayModel = entity.GetBirthday(eventId);
        }
        else if (SelectedOptionService.SelectedOption == CRUDTypeEnum.sqlCon.ToString())
        {
            birthdayModel = sqlcon.GetBirthday(eventId);
        }
        else if (SelectedOptionService.SelectedOption == CRUDTypeEnum.linQ.ToString())
        {
            birthdayModel = linq.GetBirthday(eventId);
        }
    }
}